<link rel="stylesheet" href="/style/css/admin.css">

<div class="admin-wrap">
  <h1 class="page-title">Admin Dashboard</h1>

  {{!-- ADMIN NAVIGATION BUTTONS --}}
  <div class="admin-nav" style="text-align:center; margin-bottom:2rem;">
    <a href="/admin/challenges" class="btn btn-primary" style="margin:0 0.5rem;">Manage Challenges</a>
    <a href="/admin/backlog" class="btn btn-primary" style="margin:0 0.5rem;">Manage Backlog</a>
    <a href="/admin" class="btn btn-primary" style="margin:0 0.5rem;">Add Challenge (2026)</a>
    <a href="/" class="btn" style="margin:0 0.5rem;">← Back to Site</a>
  </div>

  <p class="muted" style="text-align:center;">
    Use the buttons above to navigate between admin features.
    Below you can add new challenge entries for <strong>2026</strong> and manage global challenge stats.
  </p>

  <div class="grid">
    {{!-- FORM --}}
    <form class="card" method="POST" action="/admin/save">
      <label>Game Name
        <input name="name" id="name" placeholder="e.g., Elden Ring" required>
      </label>

      <label>Rating
        <input name="rating" id="rating" placeholder="8.5">
      </label>

      <label>Description
        <textarea name="description" id="description" placeholder="Short notes about the game" rows="4"></textarea>
      </label>

      <label>Image URL
        <input name="image" id="image" placeholder="https://...">
      </label>

      <label>Difficulty
        <input name="difficulty" id="difficulty" placeholder="Normal / Hard / etc.">
      </label>

      <label>Platform
        <input name="platform" id="platform" placeholder="PC / Switch / etc.">
      </label>

      <button class="btn btn-primary" type="submit">Add Game</button>
    </form>

    {{!-- PREVIEW --}}
    <aside class="card">
      <h2>Preview</h2>
      <div class="preview" style="display:flex; flex-direction:column; gap:0.5rem;">
        <p id="pv_name" style="font-weight:700; font-size:1.1rem;">Game name…</p>
        <p class="muted" id="pv_rating">Rating: —</p>

        <img id="pv_image"
             src=""
             alt="Game cover preview"
             style="max-width:100%; border-radius:8px; display:none; margin-bottom:0.5rem;">

        <p id="pv_description" style="font-size:0.9rem; line-height:1.4; color:#555;">Description will appear here…</p>

        <p id="pv_platform" class="muted">Platform: —</p>
        <p id="pv_difficulty" class="muted">Difficulty: —</p>
      </div>
    </aside>
  </div>

  {{!-- =============================
       ROGUELITE STREAK CONTROLS
       ============================= --}}
  <div class="card" style="max-width:480px; margin:2.5rem auto 0; text-align:center;">
    <h2 style="margin-bottom:1rem;">Roguelite Streak</h2>

    <p style="font-size:1.25rem; font-weight:600; margin-bottom:1.5rem;">
      Current Streak:
      <span style="color:#00aacc">{{rogueliteStreak}}</span>
    </p>

    <form method="POST" action="/admin/roguelite-streak/increment"
          style="display:inline-block; margin-right:.5rem;">
      <button type="submit" class="btn btn-primary">Add to Streak</button>
    </form>

    <form method="POST" action="/admin/roguelite-streak/reset"
          style="display:inline-block;">
      <button type="submit" class="btn btn-danger"
              onclick="return confirm('Reset streak to 0?');">
        Reset Streak
      </button>
    </form>
  </div>

  {{!-- =============================
       FALL GUYS CROWNS
       ============================= --}}
  <div class="card" style="max-width:480px; margin:2rem auto 0; text-align:center;">
    <h2 style="margin-bottom:1rem;">Fall Guys Crowns</h2>

    <p style="font-size:1.15rem; margin-bottom:1rem;">
      Current Crown Count:
      <span style="font-weight:700; color:#ff9800;">
        {{fallGuysCrowns}}
      </span>
    </p>

    <form method="POST" action="/admin/fall-guys/increment"
          style="display:inline-block; margin-right:.5rem;">
      <button type="submit" class="btn btn-primary">+1 Crown</button>
    </form>

    <form method="POST" action="/admin/fall-guys/update"
          style="display:inline-block; margin-top:.75rem;">
      <label style="font-size:0.9rem; display:block; margin-bottom:.25rem;">
        Set exact crown total
      </label>
      <input type="number" name="crowns" min="0"
             value="{{fallGuysCrowns}}"
             style="width:120px; padding:4px 6px; margin-right:.5rem;">
      <button type="submit" class="btn btn-primary">Save</button>
    </form>
  </div>

  {{!-- =============================
       ROCKET LEAGUE RANK
       ============================= --}}
  <div class="card" style="max-width:480px; margin:2rem auto 3rem; text-align:center;">
    <h2 style="margin-bottom:1rem;">Rocket League Rank</h2>

    <p style="font-size:1.05rem; margin-bottom:1rem;">
      Current Rank:
      <span style="font-weight:700; color:#4caf50;">
        {{rocketLeagueRank}}
      </span>
    </p>

    <form method="POST" action="/admin/rocket-league/update"
          style="margin-top:.5rem;">
      <label style="font-size:0.9rem; display:block; margin-bottom:.25rem;">
        Update rank (free text)
      </label>
      <input type="text" name="rank"
             value="{{rocketLeagueRank}}"
             placeholder="e.g., Champion 1 - Division 2"
             style="width:80%; max-width:260px; padding:4px 6px; margin-bottom:.5rem;">
      <br>
      <button type="submit" class="btn btn-primary">Save Rank</button>
    </form>
  </div>
</div>

<script>
  (function () {
    const nameEl = document.getElementById('name');
    const ratingEl = document.getElementById('rating');
    const descEl = document.getElementById('description');
    const imageEl = document.getElementById('image');
    const difficultyEl = document.getElementById('difficulty');
    const platformEl = document.getElementById('platform');

    const pvName = document.getElementById('pv_name');
    const pvRating = document.getElementById('pv_rating');
    const pvDesc = document.getElementById('pv_description');
    const pvImg = document.getElementById('pv_image');
    const pvPlatform = document.getElementById('pv_platform');
    const pvDifficulty = document.getElementById('pv_difficulty');

    function updatePreview() {
      const nameVal = nameEl.value.trim();
      const ratingVal = ratingEl.value.trim();
      const descVal = descEl.value.trim();
      const imgVal = imageEl.value.trim();
      const diffVal = difficultyEl.value.trim();
      const platVal = platformEl.value.trim();

      pvName.textContent = nameVal || 'Game name…';
      pvRating.textContent = ratingVal ? ('Rating: ' + ratingVal) : 'Rating: —';
      pvDesc.textContent = descVal || 'Description will appear here…';
      pvPlatform.textContent = 'Platform: ' + (platVal || '—');
      pvDifficulty.textContent = 'Difficulty: ' + (diffVal || '—');

      if (imgVal) {
        pvImg.src = imgVal;
        pvImg.style.display = 'block';
      } else {
        pvImg.src = '';
        pvImg.style.display = 'none';
      }
    }

    nameEl.addEventListener('input', updatePreview);
    ratingEl.addEventListener('input', updatePreview);
    descEl.addEventListener('input', updatePreview);
    imageEl.addEventListener('input', updatePreview);
    difficultyEl.addEventListener('input', updatePreview);
    platformEl.addEventListener('input', updatePreview);

    // initial render
    updatePreview();
  })();
</script>
